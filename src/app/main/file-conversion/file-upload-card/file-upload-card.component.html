<div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-lg">
  <div
    class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-t-lg py-3 px-5 text-center"
  >
    <h2 class="text-xl font-semibold">Convert Your Files</h2>
  </div>

  <form (ngSubmit)="onSubmit()" class="p-6 space-y-4">
    <!-- File Upload -->
    <div class="space-y-2">
      <label class="block text-sm font-medium text-gray-700">Choose File</label>
      <input
        type="file"
        (change)="handleFileSelect($event)"
        class="h-12 text-sm border-2 border-dashed border-gray-300 hover:border-blue-400 cursor-pointer w-full px-3 py-2 rounded-md"
        accept=".jpg,.jpeg,.png,.webp,.tiff,.gif,.avif,.heif,.pdf,.docx,.txt"
        required
      />

      <div
        *ngIf="selectedFile"
        class="bg-blue-50 p-3 rounded-md border border-blue-200"
      >
        <div class="flex items-center gap-2">
          <lucide-icon
            [name]="getFileIcon()"
            class="h-5 w-5 text-blue-600"
          ></lucide-icon>
          <div>
            <p class="text-sm font-medium text-gray-800">
              {{ selectedFile.name }}
            </p>
            <p class="text-xs text-gray-600">
              {{ formatFileSize(selectedFile.size) }} •
              {{ sourceFormat.toUpperCase() }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Format Selection -->
    <div class="space-y-2" *ngIf="selectedFile">
      <label class="block text-sm font-medium text-gray-700">Convert To</label>

      <div class="relative">
        <button
          type="button"
          (click)="toggleDropdown()"
          class="w-full h-10 text-sm border border-gray-300 rounded-md px-3 bg-white flex items-center justify-between focus:ring-2 focus:ring-blue-500"
          [class.border-blue-500]="isDropdownOpen"
        >
          <span [class.text-gray-500]="!targetFormat">
            {{
              targetFormat
                ? getFormatLabel(targetFormat)
                : "Select target format"
            }}
          </span>
          <lucide-icon
            name="chevron-down"
            class="h-4 w-4"
            [class.rotate-180]="isDropdownOpen"
          ></lucide-icon>
        </button>

        <div
          *ngIf="isDropdownOpen"
          class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg"
        >
          <button
            *ngFor="let format of getSupportedFormats()"
            type="button"
            (click)="selectFormat(format.value)"
            class="w-full px-3 py-2 text-left text-sm hover:bg-blue-50 flex items-center gap-2"
          >
            <lucide-icon [name]="format.icon" class="h-4 w-4"></lucide-icon>
            {{ format.label }}
          </button>
        </div>
      </div>

      <div
        *ngIf="targetFormat"
        class="bg-green-50 border border-green-200 p-2 rounded-md"
      >
        <span class="text-sm text-green-800">
          {{ sourceFormat.toUpperCase() }} → {{ targetFormat.toUpperCase() }}
        </span>
      </div>
    </div>

    <!-- Convert Button -->
    <button
      type="submit"
      [disabled]="!selectedFile || !targetFormat || isConverting"
      class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 disabled:opacity-50 text-white font-medium py-3 text-sm flex items-center justify-center gap-2 rounded-md"
    >
      <lucide-icon
        [name]="isConverting ? 'clock' : 'zap'"
        class="h-4 w-4"
        [class.animate-spin]="isConverting"
      ></lucide-icon>
      {{ isConverting ? "Converting..." : "Convert File" }}
    </button>
  </form>

  <div
    *ngIf="isDropdownOpen"
    class="fixed inset-0 z-0"
    (click)="closeDropdown()"
  ></div>
</div>
